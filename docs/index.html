<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>åº—èˆ—æ¡ˆå†…ã‚·ã‚¹ãƒ†ãƒ </title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="css/Proc_style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>
<body>
  <header>
    <link rel="stylesheet" href="css/Proc_style.css">
    <h1 class="site-title"></h1>
    <button id="menu-toggle" class="hamburger">â˜°</button>
    <nav id="sidebar" class="sidebar">
     <ul>
      <li><a href="itirann.html">å•†å“ä¸€è¦§</a></li>
      <li><a href="#">ãƒ¡ãƒ‹ãƒ¥ãƒ¼2</a></li>
      <li><a href="#">ãƒ¡ãƒ‹ãƒ¥ãƒ¼3</a></li>
     </ul>
    </nav>
    <form id="hidden-content">
      <label for="search"></label>
      <input type="text" id="search" name="q" placeholder="ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›">
      <button onclick="showbackContent()" id="show-back-button">Ã—</button>
    </form>
    <button onclick="showContent()" id="show-search-button">ğŸ”</button>

  </header>

  <main>
      <link rel="stylesheet" href="css/Proc_style.css">
      <img id="img" src="picture/map_open.png" alt="ç”»åƒ1">
  </main>


  <script>
    ///ä»¥ä¸‹æ¤œç´¢é …ç›®ã®è¡¨ç¤ºéè¡¨ç¤ºã®åˆ‡ã‚Šæ›¿ãˆ

    //æ¤œç´¢ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸæ™‚ã€æ¤œç´¢é …ç›®ã¨æˆ»ã‚‹ãƒœã‚¿ãƒ³ã®è¡¨ç¤ºãƒ»å…ƒã€…ã‚ã£ãŸæ¤œç´¢ãƒœã‚¿ãƒ³ã®éè¡¨ç¤º
    function showContent() {
      document.getElementById('hidden-content').style.display = 'flex';
      document.getElementById('show-search-button').style.display = 'none';
      document.getElementById('show-back-button').style.display = 'block';
      const showButton = document.getElementById('show-search-button');
    }
    //æˆ»ã‚‹ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸæ™‚ã€æ¤œç´¢é …ç›®ã¨æˆ»ã‚‹ãƒœã‚¿ãƒ³ã®éè¡¨ç¤ºãƒ»å…ƒã€…ã‚ã£ãŸæ¤œç´¢ãƒœã‚¿ãƒ³ã®è¡¨ç¤º
    function showbackContent() {
      document.getElementById('hidden-content').style.display = 'none';
      document.getElementById('show-search-button').style.display = 'block';
      document.getElementById('show-back-button').style.display = 'none';
      const showButton = document.getElementById('show-back-button');
    }
      document.getElementById('menu-toggle').addEventListener('click', function () {
        const sidebar = document.getElementById('sidebar');
        const toggleButton = document.getElementById('menu-toggle');

        sidebar.classList.toggle('active');
        toggleButton.classList.toggle('no-border');
      });
  </script>

  <script type="module">
  import { initializeApp, getApps, getApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
  import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";

  // Firebaseè¨­å®š
  const firebaseConfig = {
    apiKey: "AIzaSyAHiMCeiOFN-R4EoLTiBpeJWIUQYIrUA5M",
    authDomain: "beacon-haptic-sim.firebaseapp.com",
    projectId: "beacon-haptic-sim",
    storageBucket: "beacon-haptic-sim.appspot.com",
    messagingSenderId: "699174750938",
    appId: "1:699174750938:web:1ade40d8ef1a30c9c0b3e3",
    measurementId: "G-4QX9T79SL7"
  };

  // Firebase åˆæœŸåŒ–
  const app = getApps().length ? getApp() : initializeApp(firebaseConfig);
  const db = getFirestore(app);
  document.getElementById('hidden-content').addEventListener('submit', (event) => {
  event.preventDefault();  // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã‚’é˜»æ­¢
});


  // ğŸ” æ¤œç´¢å®Ÿè¡Œã‚¤ãƒ™ãƒ³ãƒˆ
  document.getElementById('search').addEventListener('keydown', async (event) => {
    if (event.key === 'Enter') {
      event.preventDefault();  // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡é˜²æ­¢
      const keyword = event.target.value.trim();
      if (keyword !== "") {
        await searchItems(keyword);
      }
    }
  });

  // ğŸ” æ¤œç´¢ãƒ­ã‚¸ãƒƒã‚¯
  async function searchItems(keyword) {
    const resultsContainer = document.getElementById('search-results');
    resultsContainer.innerHTML = ""; // ã‚¯ãƒªã‚¢

    const snapshot = await getDocs(collection(db, "products"));
    let found = 0;

    snapshot.forEach(doc => {
      const data = doc.data();
      const { name, category, detail, tag, image } = data;

      const keywordLower = keyword.toLowerCase();

      // æ¡ä»¶ï¼šéƒ¨åˆ†ä¸€è‡´ or ã‚¿ã‚°ä¸€è‡´
      const matches =
        (name && name.includes(keyword)) ||
        (category && category.includes(keyword)) ||
        (detail && detail.includes(keyword)) ||
        (Array.isArray(tag) && tag.some(t => t.includes(keyword)));

      if (matches) {
        found++;

        // HTMLã‚«ãƒ¼ãƒ‰ç”Ÿæˆ
        const itemHTML = `
          <div class="search-item">
            <div class="search-info">
              <h5 class="item-name">${name}</h5>
              <p class="item-category">${category}</p>
            </div>
          </div>
        `;
        resultsContainer.innerHTML += itemHTML;
      }
    });

    if (found === 0) {
      resultsContainer.innerHTML = `<p>è©²å½“ã™ã‚‹å•†å“ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>`;
    }
  }

</script>

</body>
</html>
